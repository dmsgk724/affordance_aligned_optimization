Wandb initialized: project=affordance-aligned-grasping, run=s20349_grasp_0
=== Affordance-Aligned Grasping Pipeline ===
Object: s20349, Grasp Index: 0
Initializing models...
Models initialized successfully!
Loading affordance data from: /home/dmsgk724/CVPR_2026/dataset/processed_dexgys3/s20349/xyzc.npy
Point cloud shape: (10000, 16)
Contact values range: 0.000 to 1.000
Found 7048 contact points
Representative normal: [ 0.99821008 -0.01857136 -0.05684832]
Hand model initialized with pose and contact points!
Intermediate visualizations will be saved to: visualizations
=== Starting Annealing Optimization ===
Steps: 1000
Annealing Config: temp=18.0, decay=0.95
Initial Total Energy: 148.218262
Step  100: E_total=31.313679, E_fc=6.0279, E_dis=0.0733, E_bar=0.0048, temp=15.433, accept=0.00
Visualization failed at step 100: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  200: E_total=43.240826, E_fc=8.0447, E_dis=0.0828, E_bar=0.0000, temp=13.232, accept=1.00
Visualization failed at step 200: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  300: E_total=53.946609, E_fc=2.8552, E_dis=0.0965, E_bar=0.0000, temp=10.777, accept=1.00
Visualization failed at step 300: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  400: E_total=30.679115, E_fc=4.1149, E_dis=0.0659, E_bar=0.0003, temp=9.240, accept=0.00
Visualization failed at step 400: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  500: E_total=46.639030, E_fc=5.3846, E_dis=0.0630, E_bar=0.0000, temp=7.922, accept=1.00
Visualization failed at step 500: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  600: E_total=32.954647, E_fc=8.1956, E_dis=0.0499, E_bar=0.0000, temp=6.453, accept=0.00
Visualization failed at step 600: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  700: E_total=20.479359, E_fc=4.1960, E_dis=0.0705, E_bar=0.0143, temp=5.532, accept=0.00
Visualization failed at step 700: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  800: E_total=33.728703, E_fc=2.2849, E_dis=0.0756, E_bar=0.0116, temp=4.743, accept=0.00
Visualization failed at step 800: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Step  900: E_total=22.730495, E_fc=8.2338, E_dis=0.0524, E_bar=0.0155, temp=3.863, accept=0.00
Visualization failed at step 900: 'HandModel' object has no attribute 'get_vertices'
Continuing optimization...
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 424, in <module>
    )
  File "scripts/affordance_aligned_optimization.py", line 402, in main
    }
  File "scripts/affordance_aligned_optimization.py", line 309, in run_pipeline
  File "scripts/affordance_aligned_optimization.py", line 136, in optimize_grasp_annealing
    s = optimizer.try_step()
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 87, in try_step
    self.hand_model.set_parameters(hand_pose, contact_point_indices)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/hand_model.py", line 178, in set_parameters
    self.current_status = self.chain.forward_kinematics(self.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/transform3d.py", line 233, in compose
    mat = _broadcast_bmm(mat, other.get_matrix().to(mat.device))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/transform3d.py", line 740, in _broadcast_bmm
    return a.bmm(b)
KeyboardInterrupt
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 424, in <module>
    )
  File "scripts/affordance_aligned_optimization.py", line 402, in main
    }
  File "scripts/affordance_aligned_optimization.py", line 309, in run_pipeline
  File "scripts/affordance_aligned_optimization.py", line 136, in optimize_grasp_annealing
    s = optimizer.try_step()
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 87, in try_step
    self.hand_model.set_parameters(hand_pose, contact_point_indices)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/hand_model.py", line 178, in set_parameters
    self.current_status = self.chain.forward_kinematics(self.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/transform3d.py", line 233, in compose
    mat = _broadcast_bmm(mat, other.get_matrix().to(mat.device))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/transform3d.py", line 740, in _broadcast_bmm
    return a.bmm(b)
KeyboardInterrupt
