Wandb initialized: project=affordance-aligned-grasping, run=s20349_grasp_0
=== Affordance-Aligned Grasping Pipeline ===
Object: s20349, Grasp Index: 0
Initializing models...
Models initialized successfully!
Loading affordance data from: /home/dmsgk724/CVPR_2026/dataset/processed_dexgys3/s20349/xyzc.npy
Point cloud shape: (10000, 16)
Contact values range: 0.000 to 1.000
Found 7048 contact points
Representative normal: [ 0.99821008 -0.01857136 -0.05684832]
Hand model initialized with pose and contact points!
Intermediate visualizations will be saved to: visualizations
=== Starting Annealing Optimization ===
Steps: 6000
Annealing Config: temp=18.0, decay=0.95
Initial Total Energy: 167.777588
Step  500: E_total=62.611443, E_fc=0.2555, E_dis=0.0671, E_bar=0.0000, temp=7.922, accept=1.00
Intermediate visualization saved: visualizations/s20349_grasp_0_step_0500.html
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 419, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 397, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 304, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 150, in optimize_grasp_annealing
    accept, temperature = optimizer.accept_step(energy, new_energy)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 116, in accept_step
    self.hand_model.current_status = self.hand_model.chain.forward_kinematics(self.hand_model.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 4 more times]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 89, in _forward_kinematics
    th, N = ensure_2d_tensor(th_dict.get(root.joint.name, 0.0), world.dtype, world.device)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 11, in ensure_2d_tensor
    th = th.view(1,1)
KeyboardInterrupt
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 419, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 397, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 304, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 150, in optimize_grasp_annealing
    accept, temperature = optimizer.accept_step(energy, new_energy)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 116, in accept_step
    self.hand_model.current_status = self.hand_model.chain.forward_kinematics(self.hand_model.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 4 more times]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 89, in _forward_kinematics
    th, N = ensure_2d_tensor(th_dict.get(root.joint.name, 0.0), world.dtype, world.device)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 11, in ensure_2d_tensor
    th = th.view(1,1)
KeyboardInterrupt
