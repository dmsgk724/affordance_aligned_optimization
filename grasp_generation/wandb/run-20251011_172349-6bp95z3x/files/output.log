Wandb initialized: project=affordance-aligned-grasping, run=s20349_grasp_0
=== Affordance-Aligned Grasping Pipeline ===
Object: s20349, Grasp Index: 0
Initializing models...
Models initialized successfully!
Loading affordance data from: /home/dmsgk724/CVPR_2026/dataset/processed_dexgys3/s20349/xyzc.npy
Point cloud shape: (10000, 16)
Contact values range: 0.000 to 1.000
Found 7048 contact points
Representative normal: [ 0.99821008 -0.01857136 -0.05684832]
Hand model initialized with pose and contact points!
Intermediate visualizations will be saved to: visualizations
=== Starting Annealing Optimization ===
Steps: 1000
Annealing Config: temp=18.0, decay=0.95
Initial Total Energy: 145.156799
Step  100: E_total=26.251179, E_fc=3.9292, E_dis=0.0850, E_bar=0.0051, temp=15.433, accept=1.00
Visualization failed at step 100: 'ObjectModel' object has no attribute 'object_point_cloud'
Continuing optimization...
Step  200: E_total=18.720310, E_fc=0.1199, E_dis=0.0541, E_bar=0.0051, temp=13.232, accept=0.00
Visualization failed at step 200: 'ObjectModel' object has no attribute 'object_point_cloud'
Continuing optimization...
Step  300: E_total=41.220650, E_fc=0.0105, E_dis=0.0914, E_bar=0.0000, temp=10.777, accept=0.00
Visualization failed at step 300: 'ObjectModel' object has no attribute 'object_point_cloud'
Continuing optimization...
Step  400: E_total=26.937210, E_fc=2.2459, E_dis=0.0498, E_bar=0.0042, temp=9.240, accept=0.00
Visualization failed at step 400: 'ObjectModel' object has no attribute 'object_point_cloud'
Continuing optimization...
Step  500: E_total=25.743019, E_fc=5.2012, E_dis=0.0421, E_bar=0.0059, temp=7.922, accept=0.00
Visualization failed at step 500: 'ObjectModel' object has no attribute 'object_point_cloud'
Continuing optimization...
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 439, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 417, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 324, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 151, in optimize_grasp_annealing
    accept, temperature = optimizer.accept_step(energy, new_energy)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 116, in accept_step
    self.hand_model.current_status = self.hand_model.chain.forward_kinematics(self.hand_model.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 1 more time]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/frame.py", line 101, in get_transform
    t = tf.Transform3d(rot=tf.axis_angle_to_quaternion(theta * self.joint.axis), dtype=dtype, device=d)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/rotation_conversions.py", line 479, in axis_angle_to_quaternion
    0.5 - (angles[small_angles] * angles[small_angles]) / 48
  File "/home/dmsgk724/anaconda3/envs/dexgys/lib/python3.8/site-packages/torch/_tensor.py", line 30, in wrapped
    return f(*args, **kwargs)
  File "/home/dmsgk724/anaconda3/envs/dexgys/lib/python3.8/site-packages/torch/_tensor.py", line 548, in __rsub__
    return _C._VariableFunctions.rsub(self, other)
KeyboardInterrupt
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 439, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 417, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 324, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 151, in optimize_grasp_annealing
    accept, temperature = optimizer.accept_step(energy, new_energy)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 116, in accept_step
    self.hand_model.current_status = self.hand_model.chain.forward_kinematics(self.hand_model.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 1 more time]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/frame.py", line 101, in get_transform
    t = tf.Transform3d(rot=tf.axis_angle_to_quaternion(theta * self.joint.axis), dtype=dtype, device=d)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/rotation_conversions.py", line 479, in axis_angle_to_quaternion
    0.5 - (angles[small_angles] * angles[small_angles]) / 48
  File "/home/dmsgk724/anaconda3/envs/dexgys/lib/python3.8/site-packages/torch/_tensor.py", line 30, in wrapped
    return f(*args, **kwargs)
  File "/home/dmsgk724/anaconda3/envs/dexgys/lib/python3.8/site-packages/torch/_tensor.py", line 548, in __rsub__
    return _C._VariableFunctions.rsub(self, other)
KeyboardInterrupt
