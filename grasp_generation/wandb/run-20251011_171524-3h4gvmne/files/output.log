Wandb initialized: project=affordance-aligned-grasping, run=s20349_grasp_0
=== Affordance-Aligned Grasping Pipeline ===
Object: s20349, Grasp Index: 0
Initializing models...
Models initialized successfully!
Loading affordance data from: /home/dmsgk724/CVPR_2026/dataset/processed_dexgys3/s20349/xyzc.npy
Point cloud shape: (10000, 16)
Contact values range: 0.000 to 1.000
Found 7048 contact points
Representative normal: [ 0.99821008 -0.01857136 -0.05684832]
Hand model initialized with pose and contact points!
Intermediate visualizations will be saved to: visualizations
=== Starting Annealing Optimization ===
Steps: 1000
Annealing Config: temp=18.0, decay=0.95
Initial Total Energy: 146.001572
Step  100: E_total=54.489021, E_fc=4.4425, E_dis=0.0710, E_bar=0.0000, temp=15.433, accept=1.00
Visualization failed at step 100:

Kaleido requires Google Chrome to be installed.

Either download and install Chrome yourself following Google's instructions for your operating system,
or install it from your terminal by running:

    $ plotly_get_chrome


Continuing optimization...
Step  200: E_total=63.310738, E_fc=2.4032, E_dis=0.1005, E_bar=0.0000, temp=13.232, accept=1.00
Visualization failed at step 200:

Kaleido requires Google Chrome to be installed.

Either download and install Chrome yourself following Google's instructions for your operating system,
or install it from your terminal by running:

    $ plotly_get_chrome


Continuing optimization...
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 421, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 399, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 306, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 152, in optimize_grasp_annealing
    accept, temperature = optimizer.accept_step(energy, new_energy)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 116, in accept_step
    self.hand_model.current_status = self.hand_model.chain.forward_kinematics(self.hand_model.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 3 more times]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/frame.py", line 101, in get_transform
    t = tf.Transform3d(rot=tf.axis_angle_to_quaternion(theta * self.joint.axis), dtype=dtype, device=d)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/rotation_conversions.py", line 478, in axis_angle_to_quaternion
    sin_half_angles_over_angles[small_angles] = (
KeyboardInterrupt
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 421, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 399, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 306, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 152, in optimize_grasp_annealing
    accept, temperature = optimizer.accept_step(energy, new_energy)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 116, in accept_step
    self.hand_model.current_status = self.hand_model.chain.forward_kinematics(self.hand_model.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 3 more times]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/frame.py", line 101, in get_transform
    t = tf.Transform3d(rot=tf.axis_angle_to_quaternion(theta * self.joint.axis), dtype=dtype, device=d)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/rotation_conversions.py", line 478, in axis_angle_to_quaternion
    sin_half_angles_over_angles[small_angles] = (
KeyboardInterrupt
