Wandb initialized: project=affordance-aligned-grasping, run=s20349_grasp_0
=== Affordance-Aligned Grasping Pipeline ===
Object: s20349, Grasp Index: 0
Initializing models...
Models initialized successfully!
Loading affordance data from: /home/dmsgk724/CVPR_2026/dataset/processed_dexgys3/s20349/xyzc.npy
Point cloud shape: (10000, 16)
Contact values range: 0.000 to 1.000
Found 7048 contact points
Representative normal: [ 0.99821008 -0.01857136 -0.05684832]
Hand model initialized with pose and contact points!
Intermediate visualizations will be saved to: visualizations
=== Starting Annealing Optimization ===
Steps: 6000
Annealing Config: temp=18.0, decay=0.95
Initial Total Energy: 165.321167
Step  500: E_total=52.658989, E_fc=6.6321, E_dis=0.0599, E_bar=0.0015, temp=7.922, accept=0.00
Visualization failed at step 500:
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

Continuing optimization...
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 419, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 397, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 304, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 135, in optimize_grasp_annealing
    s = optimizer.try_step()
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 87, in try_step
    self.hand_model.set_parameters(hand_pose, contact_point_indices)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/hand_model.py", line 178, in set_parameters
    self.current_status = self.chain.forward_kinematics(self.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 3 more times]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/frame.py", line 101, in get_transform
    t = tf.Transform3d(rot=tf.axis_angle_to_quaternion(theta * self.joint.axis), dtype=dtype, device=d)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/transform3d.py", line 199, in __init__
    rot = quaternion_to_matrix(rot)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/rotation_conversions.py", line 57, in quaternion_to_matrix
    o = torch.stack(
KeyboardInterrupt
Traceback (most recent call last):
  File "scripts/affordance_aligned_optimization.py", line 419, in <module>
    main()
  File "scripts/affordance_aligned_optimization.py", line 397, in main
    results = optimizer.run_pipeline(
  File "scripts/affordance_aligned_optimization.py", line 304, in run_pipeline
    optimized_pose = self.optimize_grasp_annealing(
  File "scripts/affordance_aligned_optimization.py", line 135, in optimize_grasp_annealing
    s = optimizer.try_step()
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/optimizer.py", line 87, in try_step
    self.hand_model.set_parameters(hand_pose, contact_point_indices)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/grasp_generation/utils/hand_model.py", line 178, in set_parameters
    self.current_status = self.chain.forward_kinematics(self.hand_pose[:, 9:])
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 106, in forward_kinematics
    return self._forward_kinematics(self._root, th_dict, world)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 94, in _forward_kinematics
    link_transforms.update(Chain._forward_kinematics(child, th_dict, trans))
  [Previous line repeated 3 more times]
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/chain.py", line 91, in _forward_kinematics
    trans = world.compose(root.get_transform(th.view(N, 1)))
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/frame.py", line 101, in get_transform
    t = tf.Transform3d(rot=tf.axis_angle_to_quaternion(theta * self.joint.axis), dtype=dtype, device=d)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/transform3d.py", line 199, in __init__
    rot = quaternion_to_matrix(rot)
  File "/home/dmsgk724/CVPR_2026/grasping/DexGraspNet/thirdparty/pytorch_kinematics/pytorch_kinematics/transforms/rotation_conversions.py", line 57, in quaternion_to_matrix
    o = torch.stack(
KeyboardInterrupt
